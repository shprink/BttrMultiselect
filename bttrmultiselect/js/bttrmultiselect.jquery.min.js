!function(){var t,e,i,n,s=function(t,e){return function(){return t.apply(e,arguments)}};i=function(){function t(t){var e,i,n,s;for(this.index=0,this.hasGroup=!1,this.parsed=[],s=t.childNodes,i=0,n=s.length;n>i;i++)e=s[i],this.addNode(e);return this}return t.prototype.addNode=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.addGroup(t):this.addOption(t)},t.prototype.addGroup=function(t){var e,i,n,s,o,r,l;for(this.hasGroup=!0,e=this.parsed.length,i={group:!0,index:this.index,text:t.label,disabled:t.disabled,children:[]},this.parsed.push(i),this.index+=1,r=t.childNodes,l=[],s=0,o=r.length;o>s;s++)n=r[s],l.push(this.addOption(n,e,i.index,i.disabled));return l},t.prototype.addOption=function(t,e,i,n){var s;return"OPTION"===t.nodeName.toUpperCase()?(s={index:this.index},""!==t.text?(s.text=t.text,s.selected=t.selected,s.disabled=n===!0?n:t.disabled):s.empty=!0,e?this.parsed[e].children.push(s):this.parsed.push(s),this.index+=1):void 0},t}(),e=function(){function e(e,i){var n;this.select=e,this.options=null!=i?i:{},this._testGlobalClick=s(this._testGlobalClick,this),this.$select=t(this.select),t.extend(this.options,this._getDefaultOptions(),this.options),n=this.$select.attr("multiple"),this.isMultiple="undefined"!=typeof n&&n!==!1?!0:!1,this.$bttrSelect=t(this._getTemplate()),this.$button=this.$bttrSelect.find("a.bttrmultiselect-button"),this.$search=this.$bttrSelect.find("div.bttrmultiselect-search input"),this.$list=this.$bttrSelect.find("ul.bttrmultiselect-list"),this.$bttrSelect.insertAfter(this.$select),this.width=this.$select.outerWidth(),this._bindEvents(),this.$select.hide(),this.refresh(),this.$select.addClass("bttrmultiselect-done"),this.opened=!1}return e.prototype._getDefaultOptions=function(){var t;return t={search:!0,parsing_on_instanciation:!0}},e.prototype._getTemplate=function(){return"<div class='bttrmultiselect'>\n	<div class='bttrmultiselect-inner'>\n		<a href=\"javascript:void(0)\" class='bttrmultiselect-button'>\n			<span class=\"bttrmultiselect-selected\"></span>\n			<b></b>\n		</a>\n		<div class='bttrmultiselect-content'>\n			<div class='bttrmultiselect-search'>\n				<input type=\"text\" />\n			</div>\n			<ul class='bttrmultiselect-list'></ul>\n		</div>\n	</div>\n</div>"},e.prototype._bindEvents=function(){var t=this;return this.$button.on("click",function(){return t.opened?t.close():t.open()}),this.$bttrSelect.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){return t.opened?t.$search.focus():(t.$search.blur(),t._resetSearch())})},e.prototype._setButtonWidth=function(){return this.$button.css("width",this.width)},e.prototype._setContentWidth=function(){return this.$bttrSelect.css("width",this.width)},e.prototype._setContentPosition=function(){var t;return t=this.$button.offset(),this.$bttrSelect.css({top:t.top,left:t.left})},e.prototype._resetSearch=function(){return this.$search.val("")},e.prototype._testGlobalClick=function(t){return this.$bttrSelect.find(t.target).length?void 0:this.close()},e.prototype._injectNodes=function(){var t,e,i,n,s;for(this.$list.empty(),n=this.data.parsed,s=[],e=0,i=n.length;i>e;e++)t=n[e],t.group?s.push(this._injectGroup(t)):t.empty?s.push(void 0):s.push(this._injectOption(t));return s},e.prototype._injectGroup=function(e){var i,n,s,o,r,l,c;for(n=[],n.push("bttr-group"),e.disabled&&n.push("bttr-group-disabled"),i=t('<li data-index="'+e.index+'" class="'+n.join(" ")+'">\n	<div>'+e.text+"<span>"+e.children.length+'</span></div>\n	<ul class="bttr-options"></ul>\n</li>'),this.$list.append(i),l=e.children,c=[],o=0,r=l.length;r>o;o++)s=l[o],c.push(this._injectOption(s,i));return c},e.prototype._injectOption=function(e,i){var n,s;return s=[],s.push("bttr-option"),e.disabled&&s.push("bttr-option-disabled"),e.selected&&s.push("bttr-option-selected"),n=t('<li data-index="'+e.index+'" class="'+s.join(" ")+'">\n	<div>'+e.text+"</div>\n</li>"),i?i.find("ul.bttr-options").append(n):this.$list.append(n)},e.prototype.open=function(){return this.$bttrSelect.addClass("on"),t(document).click(this._testGlobalClick),this.opened=!0},e.prototype.close=function(){return this.$bttrSelect.removeClass("on"),t(document).unbind("click",this._testGlobalClick),this.opened=!1},e.prototype.refresh=function(){return this.data=new i(this.select),this._setButtonWidth(),this._setContentWidth(),this._setContentPosition(),this._injectNodes(),console.log("refreshing")},e.prototype.checkAll=function(){},e.prototype.uncheckAll=function(){},e.prototype.enable=function(){},e.prototype.disable=function(){},e.prototype.getChecked=function(){return this.$select.find("option:checked")},e.prototype.setOptions=function(){},e.prototype.destroy=function(){return this.$select.removeClass("bttrmultiselect-done")},e}(),n=this,t=jQuery,t.fn.extend({bttrmultiselect:function(i){return this.each(function(){var n;return n=t(this),n.hasClass("bttrmultiselect-done")?void 0:n.data("bttrmultiselect",new e(this,i))})}})}.call(this);